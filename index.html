<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Flower Power">
<meta name="author" content="Figura 01">
<meta name="dcterms.date" content="2025-04-14">

<title>THC and CBD Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-e214c6ac0e6a06e3e1271511f09d2a60.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="index_files/libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="index_files/libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="index_files/libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="index_files/libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<link href="index_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="index_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="index_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="index_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="index_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="index_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="index_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="index_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="index_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="index_files/libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="index_files/libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="index_files/libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#time-of-data-collection" id="toc-time-of-data-collection" class="nav-link" data-scroll-target="#time-of-data-collection">Time of data collection</a></li>
  <li><a href="#thc-by-time-of-data-collection" id="toc-thc-by-time-of-data-collection" class="nav-link" data-scroll-target="#thc-by-time-of-data-collection">THC by time of data collection</a></li>
  <li><a href="#sample-locations" id="toc-sample-locations" class="nav-link" data-scroll-target="#sample-locations">Sample Locations</a></li>
  <li><a href="#cbd-by-time-of-data-collection" id="toc-cbd-by-time-of-data-collection" class="nav-link" data-scroll-target="#cbd-by-time-of-data-collection">CBD by time of data collection</a></li>
  <li><a href="#thc-and-cbd-distribution" id="toc-thc-and-cbd-distribution" class="nav-link" data-scroll-target="#thc-and-cbd-distribution">THC and CBD distribution</a>
  <ul class="collapse">
  <li><a href="#cbd-distribution" id="toc-cbd-distribution" class="nav-link" data-scroll-target="#cbd-distribution">CBD Distribution</a></li>
  <li><a href="#thc-distribution" id="toc-thc-distribution" class="nav-link" data-scroll-target="#thc-distribution">THC Distribution</a></li>
  </ul></li>
  <li><a href="#thc-curve-for-comparison" id="toc-thc-curve-for-comparison" class="nav-link" data-scroll-target="#thc-curve-for-comparison">THC curve for comparison</a></li>
  <li><a href="#thccbd-ratio" id="toc-thccbd-ratio" class="nav-link" data-scroll-target="#thccbd-ratio">THC/CBD ratio</a></li>
  <li><a href="#summary-of-findings" id="toc-summary-of-findings" class="nav-link" data-scroll-target="#summary-of-findings">Summary of Findings</a>
  <ul class="collapse">
  <li><a href="#thc-content" id="toc-thc-content" class="nav-link" data-scroll-target="#thc-content">THC Content</a></li>
  <li><a href="#cbd-content" id="toc-cbd-content" class="nav-link" data-scroll-target="#cbd-content">CBD Content</a></li>
  <li><a href="#relationship-between-thc-and-cbd" id="toc-relationship-between-thc-and-cbd" class="nav-link" data-scroll-target="#relationship-between-thc-and-cbd">Relationship Between THC and CBD</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">THC and CBD Analysis</h1>
<p class="subtitle lead">Data collection from Flower Power</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Flower Power <a href="mailto:hola@flowerpower.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Flower Power
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Figura 01 <a href="mailto:hola@figura01.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Figura 01
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 14, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We explore data from 533 cannabis samples collected between September 2020 and October 2024. (add more details about the data, who collected them, why people would want to know the THC and CBD levels of a sample, who were the producers, etc.) We examine what their distributions look like, and how the two compounds relate to each other.</p>
</section>
<section id="time-of-data-collection" class="level1">
<h1>Time of data collection</h1>
<p>Our data spans a period from late 2020 to late 2024.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="thc-by-time-of-data-collection" class="level1">
<h1>THC by time of data collection</h1>
<p>When we look at the THC levels over time, we observed that samples collected in the most recent year tend to have higher THC concentrations.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This trend can be interpreted as an increase in THC levels over time, but itâ€™s important to consider potential sampling biases.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section>
<section id="sample-locations" class="level1">
<h1>Sample Locations</h1>
<p>Our samples were collected from 15 different locations across Colombia, representing diverse geographical regions from coastal areas to inland territories. The interactive map below allows you to explore the sampling locations - you can zoom, pan, and click on markers to see location details.</p>
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-627dc15eec56010f8989" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-627dc15eec56010f8989">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,"Light",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter",null,"Dark",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Satellite",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[6.2442,4.711,7.1254,3.4516,3.0371,10.3932,3.1716,5.0268,5.0687,6.2442,2.9273,7.3753,1.8479,11.2404,3.6997],[-75.5742,-74.07210000000001,-73.1198,-76.532,-76.4241,-75.4832,-76.2597,-74.02679999999999,-75.5176,-75.5812,-75.28189999999999,-72.6498,-76.054,-74.20950000000001,-76.4358],{"iconUrl":{"data":"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png","index":0},"iconWidth":25,"iconHeight":41,"iconAnchorX":12,"iconAnchorY":41},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<b>Antioquia<\/b><br>Latitude: 6.2442<br>Longitude: -75.5742","<b>BogotÃ¡<\/b><br>Latitude: 4.711<br>Longitude: -74.0721","<b>Bucaramanga<\/b><br>Latitude: 7.1254<br>Longitude: -73.1198","<b>Cali<\/b><br>Latitude: 3.4516<br>Longitude: -76.532","<b>Caloto<\/b><br>Latitude: 3.0371<br>Longitude: -76.4241","<b>Cartagena<\/b><br>Latitude: 10.3932<br>Longitude: -75.4832","<b>Corinto<\/b><br>Latitude: 3.1716<br>Longitude: -76.2597","<b>Cundinamarca<\/b><br>Latitude: 5.0268<br>Longitude: -74.0268","<b>Manizales<\/b><br>Latitude: 5.0687<br>Longitude: -75.5176","<b>MedellÃ­n<\/b><br>Latitude: 6.2442<br>Longitude: -75.5812","<b>Neiva<\/b><br>Latitude: 2.9273<br>Longitude: -75.2819","<b>Pamplona<\/b><br>Latitude: 7.3753<br>Longitude: -72.6498","<b>Pitalito<\/b><br>Latitude: 1.8479<br>Longitude: -76.054","<b>Santa Marta<\/b><br>Latitude: 11.2404<br>Longitude: -74.2095","<b>Vijes<\/b><br>Latitude: 3.6997<br>Longitude: -76.4358"],null,null,null,["Antioquia","BogotÃ¡","Bucaramanga","Cali","Caloto","Cartagena","Corinto","Cundinamarca","Manizales","MedellÃ­n","Neiva","Pamplona","Pitalito","Santa Marta","Vijes"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[["Light","Dark","Satellite"],[],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"addLegend","args":[{"colors":["#003E42"],"labels":["Sample Location"],"na_color":null,"na_label":"NA","opacity":0.7,"position":"bottomright","type":"unknown","title":null,"extra":null,"layerId":null,"className":"info legend","group":null}]}],"setView":[[4.5709,-74.29730000000001],6,[]],"limits":{"lat":[1.8479,11.2404],"lng":[-76.532,-72.6498]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The geographical distribution spans from the Caribbean coast (Santa Marta, Cartagena) to the interior regions (BogotÃ¡, MedellÃ­n) and southern territories (Pitalito), representing samples from various growing conditions and cultivation practices across Colombia.</p>
</section>
<section id="cbd-by-time-of-data-collection" class="level1">
<h1>CBD by time of data collection</h1>
<p>CBD levels show a similar pattern with small decreases over time.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="thc-and-cbd-distribution" class="level1">
<h1>THC and CBD distribution</h1>
<p>The average THC content was found to be 12.8%, with the middle half of samples ranging from 10.3% to 15.3%. In contrast, CBD levels were much lower, averaging just 0.9%, with most samples falling between 0.2% and 1.1%.</p>
<div class="cell">
<div class="cell-output-display">
<div id="cbmwbpjjqq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cbmwbpjjqq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cbmwbpjjqq thead, #cbmwbpjjqq tbody, #cbmwbpjjqq tfoot, #cbmwbpjjqq tr, #cbmwbpjjqq td, #cbmwbpjjqq th {
  border-style: none;
}

#cbmwbpjjqq p {
  margin: 0;
  padding: 0;
}

#cbmwbpjjqq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cbmwbpjjqq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cbmwbpjjqq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cbmwbpjjqq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cbmwbpjjqq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cbmwbpjjqq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbmwbpjjqq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cbmwbpjjqq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cbmwbpjjqq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cbmwbpjjqq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cbmwbpjjqq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cbmwbpjjqq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cbmwbpjjqq .gt_spanner_row {
  border-bottom-style: hidden;
}

#cbmwbpjjqq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cbmwbpjjqq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cbmwbpjjqq .gt_from_md > :first-child {
  margin-top: 0;
}

#cbmwbpjjqq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cbmwbpjjqq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cbmwbpjjqq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cbmwbpjjqq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cbmwbpjjqq .gt_row_group_first td {
  border-top-width: 2px;
}

#cbmwbpjjqq .gt_row_group_first th {
  border-top-width: 2px;
}

#cbmwbpjjqq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbmwbpjjqq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cbmwbpjjqq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cbmwbpjjqq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbmwbpjjqq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbmwbpjjqq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cbmwbpjjqq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cbmwbpjjqq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cbmwbpjjqq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbmwbpjjqq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cbmwbpjjqq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbmwbpjjqq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cbmwbpjjqq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbmwbpjjqq .gt_left {
  text-align: left;
}

#cbmwbpjjqq .gt_center {
  text-align: center;
}

#cbmwbpjjqq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cbmwbpjjqq .gt_font_normal {
  font-weight: normal;
}

#cbmwbpjjqq .gt_font_bold {
  font-weight: bold;
}

#cbmwbpjjqq .gt_font_italic {
  font-style: italic;
}

#cbmwbpjjqq .gt_super {
  font-size: 65%;
}

#cbmwbpjjqq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cbmwbpjjqq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cbmwbpjjqq .gt_indent_1 {
  text-indent: 5px;
}

#cbmwbpjjqq .gt_indent_2 {
  text-indent: 10px;
}

#cbmwbpjjqq .gt_indent_3 {
  text-indent: 15px;
}

#cbmwbpjjqq .gt_indent_4 {
  text-indent: 20px;
}

#cbmwbpjjqq .gt_indent_5 {
  text-indent: 25px;
}

#cbmwbpjjqq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cbmwbpjjqq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 533</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">THC</td>
<td class="gt_row gt_center" headers="stat_0">12.8% (10.3% - 15.3%) min 4.0 max 20.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">CBD</td>
<td class="gt_row gt_center" headers="stat_0">0.9% (0.2% - 1.1%) min 0.2 max 9.3</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Mean% (Q1% - Q3%) min Min max Max</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The following plot shows the distribution of THC and CBD levels.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="cbd-distribution" class="level2">
<h2 class="anchored" data-anchor-id="cbd-distribution">CBD Distribution</h2>
<p>The CBD data is highly right-skewed. This means that most samples have very low levels of CBD, with a sharp peak near zero and a long tail stretching toward higher values. In plain terms, nearly all of the samples have little CBD, and only a few show higher amounts.</p>
</section>
<section id="thc-distribution" class="level2">
<h2 class="anchored" data-anchor-id="thc-distribution">THC Distribution</h2>
<p>In contrast, THC levels form a more bell-shaped (or normally distributed) curve. Most of the samples cluster around the middle range (around 12.8%), with fewer samples having extremely low or extremely high levels. This indicates that THC concentrations are more consistent among the samples compared to CBD.</p>
</section>
</section>
<section id="thc-curve-for-comparison" class="level1">
<h1>THC curve for comparison</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">THC Distribution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Interactive THC Distribution</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The following plot visualizes the distribution of THC concentrations in cannabis samples. The curve shows how frequently different THC percentages occur in our dataset. Weâ€™ve marked key points in the curve:</p>
<ul>
<li>The dashed vertical lines indicate the 25th percentile (Q1), mean, and 75th percentile (Q3)</li>
<li>Q1 (25th percentile): 25% of samples have THC levels below this value</li>
<li>Mean: The average THC concentration across all samples</li>
<li>Q3 (75th percentile): 75% of samples have THC levels below this value</li>
</ul>
<p>This visualization helps you understand where a specific THC percentage falls within the overall distribution of cannabis potency in our dataset.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<pre class="shinylive-r" data-engine="r"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| standalone: true
#| components: [viewer]
#| layout: vertical
#| viewerHeight: 700
library(shiny)
library(ggplot2)

# Calculate statistics from the data
MEAN_THC &lt;- 12.8
SD_THC &lt;- 3.2
Q1_THC &lt;- 10.3
Q3_THC &lt;- 15.3

ui &lt;- fluidPage(
  titlePanel("Compare Your THC Level"),
  sidebarLayout(
    sidebarPanel(
      numericInput("thc_value", 
                  "Enter your sample's THC %:", 
                  value = 12.8,
                  min = 4,
                  max = 30,
                  step = 0.1),
      textOutput("percentile_text")
    ),
    mainPanel(
      plotOutput("thc_plot", height = "400px")
    )
  )
)

server &lt;- function(input, output) {
  # Generate distribution data
  x &lt;- seq(4, 25, length.out = 1000)
  density_data &lt;- data.frame(
    x = x,
    y = dnorm(x, mean = MEAN_THC, sd = SD_THC)
  )
  
  output$thc_plot &lt;- renderPlot({
    ggplot() +
      # Plot density curve
      geom_line(data = density_data, aes(x = x, y = y), 
                color = "#003E42ff", size = 1) +
      geom_area(data = density_data, aes(x = x, y = y), 
                fill = "#003E42ff", alpha = 0.3) +
      # Add reference lines
      geom_vline(xintercept = Q1_THC, 
                 linetype = "dashed", color = "#003E42ff", alpha = 0.7) +
      geom_vline(xintercept = Q3_THC, 
                 linetype = "dashed", color = "#003E42ff", alpha = 0.7) +
      geom_vline(xintercept = MEAN_THC, 
                 linetype = "dashed", color = "#003E42ff") +
      # Add user's THC value
      geom_vline(xintercept = input$thc_value, 
                 color = "#EEC99Bff", size = 1.5) +
      # Add labels
      annotate("text", 
               x = c(Q1_THC, Q3_THC),
               y = c(0, 0),
               label = c("Q1: 25%", "Q3: 75%"),
               vjust = -0.5,
               color = "#003E42ff") +
      # Customize theme
      theme_minimal() +
      labs(title = "THC Distribution with Your Sample",
           x = "THC (%)",
           y = "Density") +
      theme(
        text = element_text(family = "sans-serif"),
        plot.title = element_text(face = "bold"),
        panel.background = element_rect(fill = "#f8f9fa", color = NA),
        plot.background = element_rect(fill = "#f8f9fa", color = NA)
      )
  })
  
  output$percentile_text &lt;- renderText({
    value &lt;- input$thc_value
    if (value &lt; Q1_THC) {
      sprintf("Your sample's THC level (%.1f%%) is below the 25th percentile (Q1: %.1f%%)", 
             value, Q1_THC)
    } else if (value &gt; Q3_THC) {
      sprintf("Your sample's THC level (%.1f%%) is above the 75th percentile (Q3: %.1f%%)", 
             value, Q3_THC)
    } else {
      sprintf("Your sample's THC level (%.1f%%) is between the 25th and 75th percentiles (Q1: %.1f%%, Q3: %.1f%%)", 
             value, Q1_THC, Q3_THC)
    }
  })
}

shinyApp(ui, server)</code></pre>
<p>This interactive visualization:</p>
<ol type="1">
<li>Shows the THC distribution curve</li>
<li>Displays reference lines for Q1 (25th percentile), median, and Q3 (75th percentile)</li>
<li>Allows users to input their sampleâ€™s THC percentage</li>
<li>Shows their value as an amber-colored vertical line on the plot</li>
<li>Provides text feedback about where their sample falls in the distribution</li>
<li>Uses the same color scheme as the rest of your document (#003E42ff and #EEC99Bff)</li>
<li>Has a clean, minimal design that matches your documentâ€™s style</li>
</ol>
<p>The plot will update automatically when users change the THC value, and it works well for GitHub Pages since it uses Shinylive. Users can: - Input any THC value between 4% and 30% - See exactly where their sample falls in the distribution - Get immediate text feedback about their sampleâ€™s percentile - Compare their value to the population statistics</p>
<p>Would you like me to: 1. Adjust the plotâ€™s appearance or size? 2. Add more statistical information? 3. Modify the input range or step size? 4. Add additional interactive features?</p>
</div>
</div>
</div>
</section>
<section id="thccbd-ratio" class="level1">
<h1>THC/CBD ratio</h1>
<p>Our analysis shows that THC and CBD have an inverse relationship - when one goes up, the other tends to go down. This pattern is most clear in samples with less than 10% THC. In samples with higher THC content (above 10%), this inverse relationship still exists but becomes weaker.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When we look at the correlation between THC and CBD using the samples with more than 10% THC, we see that the negative correlation is -0.19 which indicates a negative relationship between the two compounds but itâ€™s not very strong.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</section>
<section id="summary-of-findings" class="level1">
<h1>Summary of Findings</h1>
<p>Our analysis of 533 cannabis samples collected between 2020 and 2024 reveals several key insights:</p>
<section id="thc-content" class="level2">
<h2 class="anchored" data-anchor-id="thc-content">THC Content</h2>
<ul>
<li><strong>Average THC:</strong> 12.8%, with the middle half of samples ranging from 10.3% to 15.3%</li>
<li>THC levels follow a relatively normal distribution, indicating consistency across samples</li>
<li>There is a noticeable upward trend in THC content in more recent samples</li>
</ul>
</section>
<section id="cbd-content" class="level2">
<h2 class="anchored" data-anchor-id="cbd-content">CBD Content</h2>
<ul>
<li><strong>Average CBD:</strong> 0.9%, with most samples containing between 0.2% and 1.1%</li>
<li>CBD distribution is highly right-skewed, with most samples having very low levels</li>
<li>CBD levels show a slight downward trend over the collection period</li>
</ul>
</section>
<section id="relationship-between-thc-and-cbd" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-thc-and-cbd">Relationship Between THC and CBD</h2>
<ul>
<li>There is an inverse relationship between THC and CBD levels</li>
<li>This negative correlation is strongest when THC is below 10%</li>
<li>As THC levels increase beyond 10%, the relationship becomes less pronounced</li>
</ul>
<p>These findings highlight the predominance of high-THC, low-CBD cannabis in the samples analyzed, with a trend toward increasing THC potency over time. This information can be valuable for consumers, producers, and regulators in understanding the current cannabis market landscape.</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If our data sources remained consistent throughout the collection period, we could attribute this to actual changes in cannabis cultivation practices. However, itâ€™s possible that our more recent samples disproportionately represent producers with advanced cultivation capabilities and greater resources, who can achieve higher THC concentrations.<a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
<li id="fn2"><p>In correlation analysis, values between 0 and Â±0.3 are considered weak, Â±0.3 to Â±0.7 moderate, and Â±0.7 to Â±1.0 strong. Our correlation falls in the weak to moderate range, suggesting the relationship isnâ€™t strong.<a href="#fnref2" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>